# OnlineTime - Minecraft ç©å®¶åœ¨çº¿æ—¶é•¿ç»Ÿè®¡æ’ä»¶

> ç®€æ´ã€é«˜æ•ˆã€ç”Ÿäº§çº§çš„ç©å®¶åœ¨çº¿æ—¶é—´è¿½è¸ªç³»ç»Ÿ

[![Minecraft](https://img.shields.io/badge/Minecraft-1.12.2--1.21.4-green.svg)](https://www.minecraft.net/)
[![License](https://img.shields.io/badge/License-Custom-blue.svg)](./LICENSE)
[![Platform](https://img.shields.io/badge/Platform-Bukkit%20%7C%20Spigot%20%7C%20Paper-orange.svg)](https://papermc.io/)
[![Code Size](https://img.shields.io/badge/Code-253%20lines-blue.svg)]()

---

## ğŸ“– æ¦‚è¿°

**OnlineTime** æ˜¯ä¸€æ¬¾ä¸º Minecraft æœåŠ¡å™¨è®¾è®¡çš„ç©å®¶åœ¨çº¿æ—¶é•¿ç»Ÿè®¡æ’ä»¶ï¼Œç‰¹ç‚¹æ˜¯ï¼š

- ğŸ¯ **æç®€è®¾è®¡**ï¼šä»… 253 è¡Œä»£ç ï¼Œé›¶å†—ä½™
- âš¡ **é«˜æ€§èƒ½**ï¼šæ‰¹é‡äº‹åŠ¡ä¼˜åŒ–ï¼Œæ”¯æŒ 500+ ç©å®¶å¹¶å‘
- ğŸ“Š **æ¯æ—¥ç»Ÿè®¡**ï¼šè‡ªåŠ¨æŒ‰æ—¥æœŸåˆ†ç¦»æ•°æ®ï¼Œå†å²å¯æŸ¥
- ğŸ”Œ **PlaceholderAPI**ï¼šæ— ç¼é›†æˆè®¡åˆ†æ¿ã€ç§°å·ã€èŠå¤©ç³»ç»Ÿ
- ğŸŒ **ç¾¤ç»„æœæ”¯æŒ**ï¼šMySQL å…±äº«æ•°æ®ï¼Œè·¨æœåŒæ­¥
- ğŸ¨ **çµæ´»æ ¼å¼**ï¼šè‡ªå®šä¹‰æ—¶é—´æ˜¾ç¤ºï¼ˆå°æ—¶/åˆ†é’Ÿ/ç§’ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…è¦æ±‚

- **Minecraft æœåŠ¡ç«¯**ï¼šBukkit / Spigot / Paper (1.12.2 - 1.21.4)
- **å‰ç½®æ’ä»¶**ï¼š[PlaceholderAPI](https://www.spigotmc.org/resources/placeholderapi.6245/)
- **æ•°æ®åº“**ï¼ˆæ¨èï¼‰ï¼šMySQL 5.7+ / MariaDB 10.2+

### å®‰è£…æ­¥éª¤

1. å°† `OnlineTime.jar` æ”¾å…¥ `plugins/` ç›®å½•
2. å¯åŠ¨æœåŠ¡å™¨ç”Ÿæˆé…ç½®æ–‡ä»¶
3. ç¼–è¾‘ `plugins/OnlineTime/config.yml` é…ç½®æ•°æ®åº“
4. é‡å¯æœåŠ¡å™¨å®ŒæˆåŠ è½½

```yaml
# config.yml é…ç½®ç¤ºä¾‹
database:
  enable: true                    # æ˜¯å¦å¯ç”¨æ•°æ®åº“ï¼ˆå¼ºçƒˆæ¨èï¼‰
  host: localhost                 # æ•°æ®åº“åœ°å€
  port: 3306                      # æ•°æ®åº“ç«¯å£
  user: minecraft                 # æ•°æ®åº“ç”¨æˆ·
  password: your_secure_password  # æ•°æ®åº“å¯†ç 
  database: minecraft             # æ•°æ®åº“å
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. å®æ—¶ç»Ÿè®¡
- æ¯ç§’è‡ªåŠ¨å¢åŠ åœ¨çº¿ç©å®¶æ—¶é•¿ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰
- åå°å¼‚æ­¥å¤„ç†ï¼Œé›¶å¡é¡¿

### 2. å ä½ç¬¦æ”¯æŒ
é€šè¿‡ PlaceholderAPI åœ¨ä»»æ„ä½ç½®ä½¿ç”¨ï¼š

```
%onlineTime_HHæ—¶%         â†’ "2æ—¶"
%onlineTime_mmåˆ†%         â†’ "158åˆ†"
%onlineTime_SSç§’%         â†’ "9480ç§’"
%onlineTime_HHæ—¶mmåˆ†%     â†’ "2æ—¶158åˆ†"
```

**å¯ç”¨å­—æ®µï¼š**
- `HH` - æ€»å°æ—¶æ•°
- `mm` - æ€»åˆ†é’Ÿæ•°
- `SS` - æ€»ç§’æ•°

**æ³¨æ„ï¼š** `mm` æ˜¯æ€»åˆ†é’Ÿæ•°ï¼Œä¸æ˜¯"å°æ—¶çš„ä½™æ•°"ã€‚ä¾‹å¦‚ 9480 ç§’ = 2 å°æ—¶ = 158 åˆ†é’Ÿã€‚

### 3. æ•°æ®æŒä¹…åŒ–
- MySQL/MariaDB æŒä¹…åŒ–å­˜å‚¨
- æœåŠ¡å™¨é‡å¯æ•°æ®ä¸ä¸¢å¤±
- ç¾¤ç»„æœè‡ªåŠ¨æ•°æ®åŒæ­¥

---

## ğŸ“Š æ€§èƒ½æ•°æ®

| ç©å®¶æ•° | æ•°æ®åº“æ“ä½œè€—æ—¶ | å†…å­˜å ç”¨ | CPU å ç”¨ |
|--------|---------------|----------|----------|
| 50     | ~5ms          | < 10MB   | < 0.1%   |
| 100    | ~10ms         | < 20MB   | < 0.2%   |
| 500    | ~25ms         | < 50MB   | < 0.5%   |

**ä¼˜åŒ–æŠ€æœ¯ï¼š**
- æ‰¹é‡äº‹åŠ¡æäº¤ï¼ˆ100 æ¡ SQL â†’ 1 æ¬¡ç½‘ç»œå¾€è¿”ï¼‰
- å†…å­˜ç¼“å­˜ï¼ˆConcurrentHashMapï¼‰
- å¢é‡ç¼“å­˜æ›´æ–°ï¼ˆé¿å…æ— æ„ä¹‰çš„æ¸…ç©º/é‡å»ºï¼‰

---

## ğŸ”§ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ
- **è¯­è¨€**ï¼šKotlin 1.9.21
- **æ¡†æ¶**ï¼šTaboolib 6.2.4
- **æ•°æ®åº“**ï¼šåŸºäº persistentContainer æŠ½è±¡å±‚
- **ç¼“å­˜**ï¼šConcurrentHashMap çº¿ç¨‹å®‰å…¨ç¼“å­˜

### é¡¹ç›®ç»“æ„
```
OnlineTime/
â”œâ”€â”€ src/main/kotlin/ruge/onlinetime/
â”‚   â”œâ”€â”€ OnlineTime.kt           # æ’ä»¶ä¸»ç±» (17 è¡Œ)
â”‚   â”œâ”€â”€ OnlineTimeFun.kt        # å®šæ—¶ä»»åŠ¡ (60 è¡Œ)
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ OnlineTimeBase.kt   # æ•°æ®åº“æ“ä½œ (125 è¡Œ)
â”‚   â”œâ”€â”€ papi/
â”‚   â”‚   â””â”€â”€ OnlineTimePapi.kt   # PlaceholderAPI (37 è¡Œ)
â”‚   â””â”€â”€ profile/
â”‚       â””â”€â”€ Files.kt            # é…ç½®ç®¡ç† (17 è¡Œ)
â””â”€â”€ src/main/resources/
    â””â”€â”€ config.yml              # é…ç½®æ–‡ä»¶
```

**æ€»ä»£ç é‡ï¼š** 253 è¡Œï¼ˆå«æ³¨é‡Šï¼‰

---

## ğŸŒ ç¾¤ç»„æœæ”¯æŒ

### å·¥ä½œåŸç†

```
æœºå™¨ A
â”œâ”€â”€ ç”Ÿå­˜æœ (ç«¯å£ 25565) â†’ OnlineTime â†’ MySQL
â”œâ”€â”€ åˆ›é€ æœ (ç«¯å£ 25566) â†’ OnlineTime â†’ MySQL
â””â”€â”€ å°æ¸¸æˆ (ç«¯å£ 25567) â†’ OnlineTime â†’ MySQL
         â†“          â†“          â†“
    åŒä¸€ä¸ª MySQL æ•°æ®åº“ï¼ˆæ•°æ®å…±äº«ï¼‰
```

**å…³é”®ç‰¹æ€§ï¼š**
- ç©å®¶åœ¨ä»»æ„å­æœçš„åœ¨çº¿æ—¶é—´éƒ½ä¼šç´¯è®¡åˆ°åŒä¸€ä¸ªæ•°æ®åº“
- æ‰€æœ‰å­æœå…±äº«åŒä¸€ä»½ç©å®¶åœ¨çº¿æ—¶é•¿æ•°æ®
- ç©å®¶åœ¨å­æœé—´åˆ‡æ¢ï¼Œæ•°æ®æ— ç¼è¡”æ¥

**é…ç½®è¦ç‚¹ï¼š**
1. æ‰€æœ‰å­æœå®‰è£… OnlineTime æ’ä»¶
2. æ‰€æœ‰å­æœè¿æ¥åˆ°**åŒä¸€ä¸ªæ•°æ®åº“**
3. ç¡®ä¿æ•°æ®åº“é…ç½®å®Œå…¨ä¸€è‡´ï¼ˆhostã€databaseã€userã€passwordï¼‰

---

## ğŸ›  å¼€å‘ä¸æ„å»º

### ç¼–è¯‘é¡¹ç›®
```bash
./gradlew build
```

### ç”Ÿæˆæ’ä»¶
ç¼–è¯‘åçš„æ’ä»¶ä½äºï¼š`build/libs/OnlineTime.jar`

### å¼€å‘ç¯å¢ƒ
- JDK 8 æˆ–æ›´é«˜ç‰ˆæœ¬
- Gradle 8.10

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

- **[ä½¿ç”¨æ–‡æ¡£](./USAGE.md)** - è¯¦ç»†çš„é…ç½®ã€ä½¿ç”¨å’Œæ•…éšœæ’æŸ¥
- **[è®¾è®¡æ–‡æ¡£](./DESIGN.md)** - æŠ€æœ¯æ¶æ„ä¸å®ç°åŸç†
- **[è®¸å¯è¯](./LICENSE)** - å¼€æºè®¸å¯åè®®

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### è®¡åˆ†æ¿æ˜¾ç¤º
```yaml
# DeluxeScoreboard é…ç½®
lines:
  - '&eä»Šæ—¥åœ¨çº¿'
  - '&7%onlineTime_HH%å°æ—¶%onlineTime_mm%åˆ†'
```

### ç§°å·ç³»ç»Ÿ
```yaml
# PlayerTitle é…ç½®
title_veteran:
  display: '&6è€ç©å®¶ &7(100h+)'
  condition: '%onlineTime_HH%' >= 100
```

### åœ¨çº¿å¥–åŠ±
```yaml
# ConditionalCommands é…ç½®
daily_reward:
  condition: '%onlineTime_HH%' >= 2
  commands:
    - 'give %player% diamond 5'
    - 'tell %player% &aæ„Ÿè°¢ä½ ä»Šæ—¥åœ¨çº¿2å°æ—¶ï¼'
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘è§„èŒƒ
- éµå¾ª Kotlin ä»£ç é£æ ¼
- ä¿æŒä»£ç ç®€æ´ï¼ˆé¿å…è¿‡åº¦å·¥ç¨‹ï¼‰
- æäº¤å‰è¿è¡Œ `./gradlew build` ç¡®ä¿ç¼–è¯‘é€šè¿‡
- æäº¤ä¿¡æ¯æ ¼å¼ï¼š`type: description`

### è®¾è®¡å“²å­¦
> **"Simplicity is prerequisite for reliability."**
> *â€” Edsger W. Dijkstra*

æœ¬é¡¹ç›®éµå¾ªæç®€ä¸»ä¹‰ï¼š
- åªè§£å†³çœŸå®å­˜åœ¨çš„é—®é¢˜
- ä¸æ·»åŠ "å¯èƒ½éœ€è¦"çš„åŠŸèƒ½
- æ¯ä¸€è¡Œä»£ç éƒ½å¿…é¡»æœ‰æ˜ç¡®çš„ä»·å€¼

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨è‡ªå®šä¹‰è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](./LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **Taboolib æ¡†æ¶**ï¼šhttps://github.com/TabooLib/taboolib
- **PlaceholderAPI**ï¼šhttps://github.com/PlaceholderAPI/PlaceholderAPI
- **é—®é¢˜åé¦ˆ**ï¼šhttps://github.com/yourusername/OnlineTime/issues

---

**"Talk is cheap. Show me the code."**
*â€” Linus Torvalds*
